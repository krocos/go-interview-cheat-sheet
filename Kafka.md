# Партиции и параллелизм
**Важно**: В Kafka топики сами по себе не гарантируют "очередность" в классическом понимании – порядок сохраняется только в рамках партиции.

- **Партиция (Partition)** – минимальная единица параллелизма в Kafka.
    - Данные в топике разделяются на партиции (как шарды в БД).
    - **Порядок сообщений гарантируется только в рамках одной партиции.**
    - Если важен строгий порядок, то надо использовать ключ (`key`), чтобы сообщения попадали в одну партицию.
- **Replication Factor** – каждая партиция реплицируется на несколько брокеров для отказоустойчивости.

# Consumer Groups
Kafka распределяет партиции топика между потребителями в группе.

В Kafka **распределение партиций топика между потребителями (consumer) в группе** – это механизм балансировки нагрузки, при котором каждая партиция топика назначается только **одному потребителю** из группы. Это позволяет параллельно обрабатывать сообщения из разных партиций, обеспечивая масштабируемость и отказоустойчивость.

- Если потребителей **больше**, чем партиций – часть будет без работы.
- Если потребитель падает – его партиции перераспределяются между оставшимися (rebalance).
- Если потребителей **меньше**, чем партиций, то одному потребителю достанется **несколько партиций**.

# Важно помнить
- **Один потребитель = одна или несколько партиций** (но не наоборот).
- **Rebalance** обеспечивает отказоустойчивость при изменении числа потребителей.
- **Порядок сообщений** гарантируется только в рамках партиции.